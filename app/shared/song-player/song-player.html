<div class="bb-song-player">
	<div>
		<button type="button" class="btn" ng-class="player.playing ? 'btn-info' : 'btn-success'" ng-click="playPause()"><span class="glyphicon" ng-class="player.playing ? 'glyphicon-pause' : 'glyphicon-play'"></span> {{player.playing ? 'Pause' : 'Play'}}</button>
		<button type="button" class="btn btn-danger" ng-click="stop()"><span class="glyphicon glyphicon-stop"></span> Stop</button>
		<button type="button" class="btn btn-info" ng-click="clear()"><span class="glyphicon glyphicon-trash"></span> Clear</button>
		<div class="btn-group">
			<slider ng-model="playerOptions.speed" min="60" max="180"></slider>
		</div>
		<div class="btn-group trash-drop" ng-show="dragging" ng-drop="true" ng-drag-start="dragStart()" ng-drag-stop="dragStop()">
			<span class="glyphicon glyphicon-trash"></span>
		</div>
	</div>
	<div class="song-player-container">
		<table>
			<thead>
				<tr>
					<td colspan="2" class="dummy"></td>
					<td ng-repeat="(i,a) in utils.getNumber(getLength()*4) track by $index" colspan="{{pattern.time}}" class="beat" ng-class="getBeatClass(i)"><a href="javascript:" ng-click="setPosition(i)">{{i+1}}</a></td>
				</tr>
			</thead>
			<tbody>
				<tr ng-repeat="instrumentKey in utils.getKeys(config.instruments)">
					<th>{{config.instruments[instrumentKey].name}}</th>
					<td class="instrument-operations">
						<a href="javascript:" ng-click="headphones(instrumentKey)" ng-class="playerOptions.headphones == instrumentKey ? 'active' : 'inactive'"><span class="glyphicon glyphicon-headphones"></span></a>
						<a href="javascript:" ng-click="mute(instrumentKey)" ng-class="playerOptions.mute[instrumentKey] ? 'active' : 'inactive'"><span class="glyphicon glyphicon-volume-off"></span></a>
					</td>
					<td ng-repeat="(i,a) in utils.getNumber(getLength()) track by $index" ng-if="shouldDisplay(instrumentKey, i)" class="bar" colspan="{{getColSpan(instrumentKey, i)*4}}" rowspan="{{getRowSpan(instrumentKey, i)}}"
					    ng-drop="!song[i][instrumentKey]" ng-drop-success="onDrop(instrumentKey, i, $data)">
						<bb-pattern-placeholder ng-if="song[i][instrumentKey]" bb-tune-name="song[i][instrumentKey][0]" bb-pattern-name="song[i][instrumentKey][1]" bb-draggable="true" bb-drag-success="onDrag(instrumentKey, i)" bb-player-options="getPreviewPlayerOptions(instrumentKey, i)">
							<bb-pattern-placeholder-item dropdown dropdown-append-to-body>
								<a href="javascript:" title="Pick instruments" dropdown-toggle><span class="glyphicon glyphicon-hand-right"></span></a>
								<ul class="dropdown-menu" role="menu">
									<li ng-repeat="instrumentKey2 in utils.getKeys(config.instruments)"><a href="javascript:" ng-click="toggleInstrument(instrumentKey2, i, song[i][instrumentKey])"><span class="glyphicon glyphicon-ok" ng-style="{visibility: equals(song[i][instrumentKey2], song[i][instrumentKey]) ? 'visible' : 'hidden'}"></span> {{config.instruments[instrumentKey2].name}}</a></li>
								</ul>
							</bb-pattern-placeholder-item>
							<bb-pattern-placeholder-item><a href="javascript:" ng-click="removePattern(instrumentKey, i)" title="Remove"><span class="glyphicon glyphicon-trash"></span></a></bb-pattern-placeholder-item>
						</bb-pattern-placeholder>
					</td>
				</tr>
			</tbody>
			<tfoot>
				<tr ng-show="dragging">
					<th>All</th>
					<td class="instrument-operations"></td>
					<td ng-repeat="(i,a) in utils.getNumber(getLength()) track by $index" class="all-drop" ng-drop="true" ng-drop-success="onDrop(null, i, $data)" colspan="4">(All)</td>
				</tr>
			</tfoot>
		</table>
		<div class="position-marker" ng-class="{'player-stopped': !player.playing && player.getPosition() == 0}"></div>
	</div>
</div>